var Re=Object.defineProperty;var ne=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var le=(l,n,c)=>n in l?Re(l,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[n]=c,se=(l,n)=>{for(var c in n||(n={}))Ke.call(n,c)&&le(l,c,n[c]);if(ne)for(var c of ne(n))Ve.call(n,c)&&le(l,c,n[c]);return l};import{_ as Se}from"./lodash.e6c87188.js";import{_ as Te,r,u as Ue,c as M,o as Ae,M as L,a as Qe,b as D,d as u,e as _,f as e,w as k,v as T,t as d,g as ae,F as I,h as C,i as E,j as O,k as Le,l as De,m as re,n as q,p as Ee,q as Oe,s as qe,x as de,y as Be}from"./index.6043f124.js";import{F as Ge,I as ce}from"./interchange.f9564a70.js";import{N as He}from"./note.3d491738.js";import{A as ze,H as je,Q as B}from"./index.0b553598.js";import"./axios.1406ea7e.js";const G=r([]),b=r([]),F=r([]),ie=r([]),ue=r([]),H=r(""),z=r(null),j=r(null),Pe=async()=>{try{const{data:{data:l}}=await Ge.index();G.value=l}catch(l){console.log(l)}},Je=async()=>{try{const{data:{data:l}}=await ce.index(H.value);b.value=l,z.value=b.value[0].exit_km,j.value=b.value[b.value.length-1].exit_km}catch(l){console.log(l)}},Ye=async()=>{try{const{data:{data:l}}=await ce.all();F.value=l}catch(l){console.log(l)}},Ze=async()=>{try{const{data:{data:l}}=await He.index();ie.value=l}catch(l){console.log(l)}},We=async()=>{try{const{data:{data:l}}=await B.index();ue.value=l}catch(l){console.log(l)}},Xe={components:{GoogleMap:ze,Marker:je},setup(){Pe(),Ye(),Ze(),We();const l="AIzaSyBnb8imIfiw8JHV1h-Fty9aZ-r1YVTznnc",n=Ue(),c=r(""),o=r(""),R=r(""),U=r(""),g=r(null),w=r(!1),A=r(!1),v=r(-1),f=r([]),t=r(""),m=r(null),p=r(null),Q=r(null),P=r(null),x=r({});let K=null,V=null,S=null;const N=M(()=>G.value.find(s=>s.id===H.value)),J=M(()=>N.value?["\u570B\u4E00","\u6C50\u6B62\uFF0D\u694A\u6885\u9AD8\u67B6","\u570B\u4E09","\u570B\u4E09\u7532","\u570B\u4E94"].includes(N.value.name)?["\u5317\u4E0A","\u5357\u4E0B"]:["\u6771\u5411","\u897F\u5411"]:[""]),he=M(()=>b.value.length?`\u516C\u91CC\u6578\u8ACB\u8F38\u5165${z.value}KM \uFF5E ${j.value}KM`:""),Y=M(()=>!N.value||!U.value||!g.value||g.value<z.value||g.value>j.value),_e=M(()=>!N.value),ve=M(()=>{if(!Object.keys(x.value).length)return{lat:25.0391667,lng:121.5641667};let s=x.value.latlng;const a=Number(s.split(",")[0]),i=Number(s.split(",")[1]);return{lat:a,lng:i}}),me=Se.debounce(()=>{w.value=!!o.value,F.value.length?f.value=F.value.map(s=>s.name).filter(s=>s.indexOf(o.value)>-1):f.value=["\u67E5\u7121\u4EA4\u6D41\u9053\uFF06\u670D\u52D9\u5340\u8CC7\u6599"]},500),Z=s=>{document.querySelector(".list-group").contains(s.target)||(w.value=!1,v.value=-1)},ge=()=>{v.value<f.value.length&&(v.value+=1)},fe=()=>{v.value>0&&(v.value-=1)},W=s=>{c.value=s.name,R.value=s.coords_north_west,v.value=-1,o.value="",w.value=!1,Q.value.focus()},ye=()=>{if(w.value){c.value=f.value[v.value];const s=F.value.find(a=>a.name===c.value);W(s)}},X=s=>{const a=F.value.find(i=>i.name===s);W(a)},be=()=>{if(Y.value)return;const s=b.value.filter(i=>!["\u670D\u52D9\u5340","\u4F11\u606F\u7AD9"].includes(i.name.slice(-3)));let a=null;if(J.value[0]==="\u5317\u4E0A")a=s.filter(i=>i.exit_km>=g.value&&i.coords_north_west!=="")[0];else{const i=s.filter(y=>y.exit_km<=g.value&&y.coords_south_east!=="");a=i[i.length-1]}a&&X(a.name),t.value=a.name},$=()=>{K.show()},ee=()=>{K.hide()},we=()=>{$()},ke=()=>{V.show()},pe=()=>{V.hide()},te=()=>{S.show()},oe=()=>{S.hide()},xe=(s,a)=>{const i=b.value[s];let y="";c.value=i.name,a==="N"?y=i.coords_north_west:y=i.coords_south_east,R.value=y,ee(),Q.value.focus()},Me=async()=>{if(!!c.value)try{const s={address:c.value},{data:{data:a}}=await B.new(s);x.value=a,te()}catch(s){console.log(s)}},Ie=async()=>{if(!!Object.keys(x).length)try{const s=se({},x.value),{data:{data:{id:a}}}=await B.create(s);oe(),n.push(`/results/${a}`)}catch(s){console.log(s)}},Ce=s=>{const a=new Date(s),i=a.getMonth()+1,y=a.getDate(),Ne=a.getHours(),Fe=a.getMinutes();return`${i}/${y} ${Ne}:${Fe}`};return Ae(()=>{K=new L(m.value,{}),V=new L(p.value,{}),S=new L(P.value,{}),document.addEventListener("click",Z)}),Qe(()=>{document.removeEventListener("click",Z)}),{searchText:c,searchInterchange:o,latlng:R,exitKm:g,alertTextKm:he,direction:U,directions:J,freewayId:H,freeway:N,freeways:G,queries:ue,getInterchanges:Je,interchanges:b,notes:ie,result:"",search:"",results:[],isOpen:w,arrowCounter:v,isLoading:A,filterInterchanges:f,disableFindInterchange:Y,disableLookupFreeway:_e,onArrowDown:ge,onArrowUp:fe,onEnter:ye,setResult:X,onFilterInterchanges:me,findInterchange:be,targetInterchange:t,lookupFreeways:we,showModal:$,closeModal:ee,freewayModalRef:m,freewayModal:K,noteModalRef:p,noteModal:V,setInterChange:xe,showNoteModal:ke,closeNoteModal:pe,addressRef:Q,checkModal:S,checkModalRef:P,showCheckModal:te,closeCheckModal:oe,newQuery:Me,queryResult:x,createQuery:Ie,formatTime:Ce,apiKey:l,center:ve}}},h=l=>(Ee("data-v-2fe70170"),l=l(),Oe(),l),$e={class:"container mt-5 pt-3"},et=h(()=>e("div",{class:"row"},[e("h1",null,"\u7C73\u5176\u6797\u670D\u52D9\u7DB2\u641C\u5C0B")],-1)),tt={class:"row"},ot={class:"col-10"},nt={class:"input-group my-3"},lt={class:"col-2"},st=h(()=>e("hr",null,null,-1)),at=h(()=>e("div",{class:"row"},[e("div",{class:"col-12"},[e("h3",null,"\u570B\u9053\u901F\u67E5")])],-1)),rt={class:"row"},dt={class:"col-12"},ct={class:"input-group mb-3"},it={class:"input-group-prepend"},ut={class:"input-group-text",for:"inputGroupSelect01"},ht=h(()=>e("option",{disabled:"",value:""}," \u8ACB\u9078\u64C7\u570B\u9053 ",-1)),_t=["value"],vt=h(()=>e("option",{disabled:"",value:""}," \u8ACB\u9078\u64C7\u65B9\u5411 ",-1)),mt=["value"],gt=["disabled"],ft=["disabled"],yt={id:"freeway-alert",class:"text-danger text-center"},bt=h(()=>e("hr",null,null,-1)),wt=h(()=>e("h3",null,"\u570B\u9053\u4EA4\u6D41\u9053\uFF06\u670D\u52D9\u5340\u901F\u67E5",-1)),kt={class:"input w-75"},pt={class:"list-group mb-3"},xt=["onClick","onMouseover"],Mt=h(()=>e("hr",null,null,-1)),It=h(()=>e("h3",null,"\u641C\u5C0B\u7D00\u9304",-1)),Ct={class:"table table-striped"},Nt=h(()=>e("thead",null,[e("tr",null,[e("th",null,"\u641C\u5C0B\u540D\u7A31"),e("th",null,"\u5730\u5740"),e("th",null,"\u641C\u5C0B\u6642\u9593"),e("th",null,"#")])],-1)),Ft=Be(" \u986F\u793A "),Rt={class:"row"},Kt={class:"col"},Vt={ref:"freewayModalRef",class:"modal",tabindex:"-1"},St={class:"modal-dialog modal-lg"},Tt={class:"modal-content"},Ut={class:"modal-header"},At={class:"modal-title text-dark"},Qt={class:"modal-body"},Lt={class:"table table-striped table-bordered"},Dt=h(()=>e("thead",null,[e("tr",null,[e("th",{style:{width:"20%"}}," \u4EA4\u6D41\u9053 "),e("th",{style:{width:"10%"}}," K\u6578 "),e("th",null,"\u4EA4\u6D41\u9053\u5FEB\u9078"),e("th",null,"\u5317\u4E0A\u9810\u544A\u51FA\u53E3"),e("th",null,"\u5357\u4E0B\u9810\u544A\u51FA\u53E3")])],-1)),Et=["onClick"],Ot=h(()=>e("br",null,null,-1)),qt=["onClick"],Bt={class:"row"},Gt={class:"col"},Ht={ref:"noteModalRef",class:"modal fade",tabindex:"-1",role:"dialog","aria-labelledby":"noteModalLabel","aria-hidden":"true"},zt={class:"modal-dialog modal-lg",role:"document"},jt={class:"modal-content"},Pt=h(()=>e("div",{class:"modal-header"},[e("h4",{class:"modal-title text-dark"}," \u6D3E\u9063\u6CE8\u610F\u4E8B\u9805 ")],-1)),Jt={class:"modal-body"},Yt={class:"table table-hover table-bordered"},Zt=h(()=>e("thead",{class:"thead-light"},[e("tr",null,[e("th",null,"\u9805\u6B21"),e("th",{style:{width:"90%"}}," \u6CE8\u610F\u4E8B\u9805 ")])],-1)),Wt={class:"modal-footer"},Xt={class:"row"},$t={class:"col"},eo={ref:"checkModalRef",class:"modal fade",tabindex:"-1",role:"dialog","aria-labelledby":"checkModalLabel","aria-hidden":"true"},to={class:"modal-dialog modal-lg",role:"document"},oo={class:"modal-content"},no=h(()=>e("div",{class:"modal-header"},[e("h4",{class:"modal-title text-dark"}," \u8ACB\u78BA\u8A8D\u641C\u5C0B\u5730\u9EDE\u662F\u5426\u6709\u8AA4 ")],-1)),lo={class:"modal-body"},so=h(()=>e("h5",{class:"text-danger text-right"}," \u662F\u5426\u6B63\u78BA\uFF1F ",-1)),ao={class:"modal-footer"};function ro(l,n,c,o,R,U){var v,f;const g=D("router-link"),w=D("Marker"),A=D("GoogleMap");return u(),_("div",$e,[et,e("div",tt,[e("div",ot,[e("div",nt,[k(e("input",{ref:"addressRef","onUpdate:modelValue":n[0]||(n[0]=t=>o.searchText=t),type:"text",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u641C\u5C0B\u5730\u5740\u6216\u5730\u6A19",autofocus:"",required:""},null,512),[[T,o.searchText]]),k(e("input",{"onUpdate:modelValue":n[1]||(n[1]=t=>o.latlng=t),type:"text",hidden:""},null,512),[[T,o.latlng]]),e("button",{type:"button",class:"btn btn-primary",onClick:n[2]||(n[2]=(...t)=>o.newQuery&&o.newQuery(...t))}," \u641C\u5C0B ")])]),e("div",lt,[e("button",{type:"button",class:"btn btn-warning btn-lg",onClick:n[3]||(n[3]=(...t)=>o.showNoteModal&&o.showNoteModal(...t))}," \u6D3E\u9063\u6CE8\u610F\u4E8B\u9805 ")]),st,at,e("div",rt,[e("div",dt,[e("div",ct,[e("div",it,[e("label",ut,d(o.targetInterchange),1)]),k(e("select",{"onUpdate:modelValue":n[4]||(n[4]=t=>o.freewayId=t),class:"form-select",onChange:n[5]||(n[5]=(...t)=>o.getInterchanges&&o.getInterchanges(...t))},[ht,(u(!0),_(I,null,C(o.freeways,t=>(u(),_("option",{key:t.name,value:t.id},d(t.name),9,_t))),128))],544),[[ae,o.freewayId]]),k(e("select",{"onUpdate:modelValue":n[6]||(n[6]=t=>o.direction=t),class:"form-select"},[vt,(u(!0),_(I,null,C(o.directions,t=>(u(),_("option",{key:t,value:t},d(t),9,mt))),128))],512),[[ae,o.direction]]),k(e("input",{"onUpdate:modelValue":n[7]||(n[7]=t=>o.exitKm=t),class:"form-control",type:"number",placeholder:"\u8ACB\u8F38\u5165\u516C\u91CC\u6578"},null,512),[[T,o.exitKm,void 0,{number:!0}]]),e("button",{class:"btn btn-primary",disabled:o.disableFindInterchange,onClick:n[8]||(n[8]=(...t)=>o.findInterchange&&o.findInterchange(...t))}," \u901F\u67E5\u5EA7\u6A19 ",8,gt),e("button",{class:"btn btn-success",disabled:o.disableLookupFreeway,onClick:n[9]||(n[9]=(...t)=>o.lookupFreeways&&o.lookupFreeways(...t))}," \u67E5\u570B\u9053\u8868 ",8,ft)])])]),e("p",yt,d(o.alertTextKm),1),bt,wt,e("div",kt,[k(e("input",{"onUpdate:modelValue":n[10]||(n[10]=t=>o.searchInterchange=t),type:"text",placeholder:"\u8ACB\u8F38\u5165\u4EA4\u6D41\u9053\u8207\u670D\u52D9\u5340\u6703\u6709\u81EA\u52D5\u5B8C\u6210\u63D0\u793A",class:"form-control border-info interchange",onInput:n[11]||(n[11]=(...t)=>o.onFilterInterchanges&&o.onFilterInterchanges(...t)),onKeydown:[n[12]||(n[12]=E(O((...t)=>o.onArrowDown&&o.onArrowDown(...t),["prevent"]),["down"])),n[13]||(n[13]=E(O((...t)=>o.onArrowUp&&o.onArrowUp(...t),["prevent"]),["up"])),n[14]||(n[14]=E(O((...t)=>o.onEnter&&o.onEnter(...t),["prevent"]),["enter"]))]},null,544),[[T,o.searchInterchange]]),k(e("ul",pt,[(u(!0),_(I,null,C(o.filterInterchanges,(t,m)=>(u(),_("li",{key:`${t}-search`,class:qe(["list-group-item",{active:m===o.arrowCounter}]),onClick:p=>o.setResult(t),onMouseover:p=>o.arrowCounter=m},d(t),43,xt))),128))],512),[[Le,o.isOpen]])]),Mt,It,e("table",Ct,[Nt,e("tbody",null,[(u(!0),_(I,null,C(o.queries,t=>(u(),_("tr",{key:t.id},[e("td",null,d(t.address),1),e("td",null,d(t.geo_location),1),e("td",null,d(o.formatTime(t.created_at)),1),e("td",null,[de(g,{to:`/results/${t.id}`,class:"btn btn-primary"},{default:re(()=>[Ft]),_:2},1032,["to"])])]))),128))])]),e("div",Rt,[e("div",Kt,[e("div",Vt,[e("div",St,[e("div",Tt,[e("div",Ut,[e("h4",At,d((v=o.freeway)==null?void 0:v.name),1)]),e("div",Qt,[e("table",Lt,[Dt,e("tbody",null,[(u(!0),_(I,null,C(o.interchanges,(t,m)=>(u(),_("tr",{key:m},[e("td",null,d(t.name),1),e("td",null,d(t.exit_km),1),e("td",null,[t.coords_north_west!==""?(u(),_("button",{key:0,class:"btn btn-success btn-sm mb-2",onClick:p=>o.setInterChange(m,"N")},d(t.name)+d(o.directions[0])+"\u51FA\u53E3 ",9,Et)):q("",!0),Ot,t.coords_south_east!==""?(u(),_("button",{key:1,class:"btn btn-primary btn-sm",onClick:p=>o.setInterChange(m,"S")},d(t.name)+d(o.directions[1])+"\u51FA\u53E3 ",9,qt)):q("",!0)]),e("td",null,d(t.city_north_west),1),e("td",null,d(t.city_south_east),1)]))),128))])])])])])],512)])]),e("div",Bt,[e("div",Gt,[e("div",Ht,[e("div",zt,[e("div",jt,[Pt,e("div",Jt,[e("table",Yt,[Zt,e("tbody",null,[(u(!0),_(I,null,C(o.notes,(t,m)=>(u(),_("tr",{key:t},[e("td",null,d(m+1),1),e("td",null,d(t.content),1)]))),128))])])]),e("div",Wt,[e("button",{type:"button",class:"btn btn-secondary",onClick:n[15]||(n[15]=(...t)=>o.closeNoteModal&&o.closeNoteModal(...t))}," Close ")])])])],512)])]),e("div",Xt,[e("div",$t,[e("div",eo,[e("div",to,[e("div",oo,[no,e("div",lo,[e("h5",null,"\u641C\u5C0B\u5730\u9EDE\u70BA\uFF1A"+d(o.queryResult.address),1),e("h5",null,"Google\u56DE\u50B3\u5730\u9EDE\u70BA\uFF1A"+d(o.queryResult.geo_location),1),so,(f=o.queryResult)!=null&&f.latlng?(u(),De(A,{key:0,"api-key":o.apiKey,style:{width:"100%",height:"500px"},center:o.center,zoom:15},{default:re(()=>[de(w,{options:{position:o.center}},null,8,["options"])]),_:1},8,["api-key","center"])):q("",!0)]),e("div",ao,[e("button",{class:"btn btn-secondary",onClick:n[16]||(n[16]=(...t)=>o.closeCheckModal&&o.closeCheckModal(...t))}," \u53D6\u6D88 "),e("button",{class:"btn btn-primary",onClick:n[17]||(n[17]=(...t)=>o.createQuery&&o.createQuery(...t))}," \u958B\u59CB\u641C\u5C0B ")])])])],512)])])])])}var go=Te(Xe,[["render",ro],["__scopeId","data-v-2fe70170"]]);export{go as default};
